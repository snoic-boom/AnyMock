(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7b4f"],{"+JTq":function(t,e,n){},Ebxm:function(t,e,n){"use strict";n.r(e);var a=n("GQeE"),r=n.n(a),i=n("14Xm"),c=n.n(i),s=n("P2sY"),o=n.n(s),u=n("D3Ub"),l=n.n(u),d=n("m1cH"),p=n.n(d),f=n("gDS+"),h=n.n(f),v=n("QbLZ"),g=n.n(v),b=n("L2JU"),m=n("t3Un"),x=function(){var t=l()(c.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.a)({url:"/space/update",method:"post",param:n});case 2:return e=t.sent,t.abrupt("return",e||{});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),_=function(){var t=l()(c.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.a)({url:"/space/insert",method:"post",param:n});case 2:return e=t.sent,t.abrupt("return",e||{});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),E=function(){var t=l()(c.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.a)({url:"/space/delete",method:"post",param:n});case 2:return e=t.sent,t.abrupt("return",e||{});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),D={data:function(){return{defaultProps:{children:"children",label:"label"},cacheData:[]}},computed:g()({},Object(b.b)({spaceList:function(t){return console.log("----",t.business.spaceList),t.business.spaceList.filter(function(t){if(t.variable)return t})}})),created:function(){},mounted:function(){this.$store.dispatch("getSpaceTree",{})},methods:{edit:function(t){this.$data.cacheData=JSON.parse(h()(this.spaceList));var e=[].concat(p()(this.spaceList)),n=this.getTargetData(e,t.id);n&&(n.canEdit=!0,this.$store.commit("UPDATE_SPACE_LIST",e))},save:function(t){var e=this;return l()(c.a.mark(function n(){var a,r,i;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.label){n.next=3;break}return e.$message("节点不能为空"),n.abrupt("return");case 3:if(a=[].concat(p()(e.spaceList)),!(r=e.getTargetData(a,t.id))){n.next=20;break}if(!(parseInt(t.id)>0)){n.next=12;break}return n.next=9,x({id:t.id,label:t.label});case 9:n.t0=n.sent,n.next=15;break;case 12:return n.next=14,_({label:t.label,parentId:t.copyId});case 14:n.t0=n.sent;case 15:"000000"!==(i=n.t0).resultCode&&(o()(r,e.getTargetData(e.$data.cacheData,t.id)),e.$message(i.resultMsg)),delete r.canEdit,e.$store.commit("UPDATE_SPACE_LIST",a),e.$store.dispatch("getSpaceTree",{});case 20:case"end":return n.stop()}},n,e)}))()},deleteData:function(t){var e=this;return l()(c.a.mark(function n(){return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,E({id:t.id});case 2:"000000"===n.sent.resultCode&&e.$store.dispatch("getSpaceTree",{});case 4:case"end":return n.stop()}},n,e)}))()},add:function(t){console.log("++",t);try{var e=[].concat(p()(this.spaceList));this.$data.cacheData=JSON.parse(h()(e)),0===r()(this.getTargetData(e,"-1")).length?this.$store.commit("UPDATE_SPACE_LIST",this.setTargetData(e,t)):this.$message("请完成新增项")}catch(t){}},cancel:function(t){var e=[].concat(p()(this.spaceList)),n=this.getTargetData(e,t.id);if(n){o()(n,this.getTargetData(this.$data.cacheData,t.id)),delete n.canEdit;!function t(e){e.map(function(n,a){"-1"===n.id&&e.splice(a,1),n.children&&n.children.length>0&&t(n.children)})}(e),this.$store.commit("UPDATE_SPACE_LIST",e)}},getTargetData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={};return function t(a){a.map(function(a){a.id===e&&(n=a),a.children&&a.children.length>0&&t(a.children)})}(t),n},setTargetData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function t(n){n.map(function(n,a){n.id===e.id&&(n.children||(n.children=[]),n.children.push({id:"-1",label:"",canEdit:!0,copyId:e.id,variable:!0,parentId:n&&n.parentId&&n.parentId||"0"})),n.children&&n.children.length>0&&t(n.children)})}(t),0===parseInt(e.copyId)&&t.splice(0,0,{id:"-1",label:"",canEdit:!0,copyId:0,parentId:0,variable:!0}),this.$store.commit("UPDATE_SPACE_LIST",t),t},handleChange:function(t,e){var n=[].concat(p()(this.spaceList)),a=this.getTargetData(n,t.id);a&&(o()(a,this.getTargetData(this.$data.cacheData,t.id)),a.label=e,this.$store.commit("UPDATE_SPACE_LIST",n))}}},T=(n("Iztv"),n("KHd+")),k=Object(T.a)(D,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"space_edit"},[n("div",{staticClass:"custom-tree-container"},[n("el-button",{staticStyle:{margin:"10px"},attrs:{size:"mini",type:"primary"},on:{click:function(){return t.add({id:"-1",copyId:0,parentId:0,canEdit:!0,label:"",variable:!0})}}},[t._v("添加空间节点")]),t._v(" "),n("el-tree",{attrs:{data:t.spaceList,"expand-on-click-node":!1,props:t.defaultProps,"node-key":"id","default-expand-all":""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node,r=e.data;return n("span",{staticClass:"custom-tree-node"},[r.canEdit?n("a-input",{key:r.id,staticStyle:{padding:"0",margin:"0",height:"20px",width:"50%"},attrs:{value:r.label},on:{change:function(e){return t.handleChange(r,e.target.value)}}}):n("span",[t._v(t._s(a.label))]),t._v(" "),n("span",[r.canEdit||r.allowCreateInterface?t._e():n("el-button",{attrs:{slot:"reference",size:"mini",type:"text",icon:"el-icon-plus",circle:""},on:{click:function(){return t.add(r)}},slot:"reference"}),t._v(" "),r.canEdit?n("span",[n("a",{on:{click:function(){return t.save(r)}}},[t._v("保存")]),t._v(" "),n("a-popconfirm",{attrs:{title:"确认取消?","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(){return t.cancel(r)}}},[n("a",[t._v("取消")])])],1):n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit",circle:""},on:{click:function(){return t.edit(r)}}}),t._v(" "),r.canEdit?t._e():n("a-popconfirm",{attrs:{title:"确认删除?","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(){return t.deleteData(r)}}},[n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"}})],1)],1)],1)}}])})],1)])},[],!1,null,null,null);k.options.__file="edit.vue";e.default=k.exports},GQeE:function(t,e,n){t.exports={default:n("iq4v"),__esModule:!0}},Iztv:function(t,e,n){"use strict";var a=n("+JTq");n.n(a).a},Mqbl:function(t,e,n){var a=n("JB68"),r=n("w6GO");n("zn7N")("keys",function(){return function(t){return r(a(t))}})},"gDS+":function(t,e,n){t.exports={default:n("oh+g"),__esModule:!0}},iq4v:function(t,e,n){n("Mqbl"),t.exports=n("WEpk").Object.keys},"oh+g":function(t,e,n){var a=n("WEpk"),r=a.JSON||(a.JSON={stringify:JSON.stringify});t.exports=function(t){return r.stringify.apply(r,arguments)}},zn7N:function(t,e,n){var a=n("Y7ZC"),r=n("WEpk"),i=n("KUxP");t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],c={};c[t]=e(n),a(a.S+a.F*i(function(){n(1)}),"Object",c)}}}]);