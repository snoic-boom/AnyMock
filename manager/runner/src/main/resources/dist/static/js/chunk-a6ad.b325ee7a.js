(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a6ad","chunk-7b4f"],{"+JTq":function(t,e,n){},"4+qw":function(t,e,n){"use strict";var a=n("t6V3");n.n(a).a},"6V1f":function(t,e,n){},Ebxm:function(t,e,n){"use strict";n.r(e);var a=n("GQeE"),i=n.n(a),r=n("14Xm"),s=n.n(r),c=n("P2sY"),o=n.n(c),u=n("D3Ub"),l=n.n(u),d=n("m1cH"),p=n.n(d),f=n("gDS+"),h=n.n(f),v=n("QbLZ"),g=n.n(v),m=n("L2JU"),b=n("t3Un"),x=function(){var t=l()(s.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(b.a)({url:"/space/update",method:"post",param:n});case 2:return e=t.sent,t.abrupt("return",e||{});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),_=function(){var t=l()(s.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(b.a)({url:"/space/insert",method:"post",param:n});case 2:return e=t.sent,t.abrupt("return",e||{});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),I=function(){var t=l()(s.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(b.a)({url:"/space/delete",method:"post",param:n});case 2:return e=t.sent,t.abrupt("return",e||{});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),k={data:function(){return{defaultProps:{children:"children",label:"label"},cacheData:[]}},computed:g()({},Object(m.b)({spaceList:function(t){return console.log("----",t.business.spaceList),t.business.spaceList.filter(function(t){if(t.variable)return t})}})),created:function(){},mounted:function(){this.$store.dispatch("getSpaceTree",{})},methods:{edit:function(t){this.$data.cacheData=JSON.parse(h()(this.spaceList));var e=[].concat(p()(this.spaceList)),n=this.getTargetData(e,t.id);n&&(n.canEdit=!0,this.$store.commit("UPDATE_SPACE_LIST",e))},save:function(t){var e=this;return l()(s.a.mark(function n(){var a,i,r;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.label){n.next=3;break}return e.$message("节点不能为空"),n.abrupt("return");case 3:if(a=[].concat(p()(e.spaceList)),!(i=e.getTargetData(a,t.id))){n.next=20;break}if(!(parseInt(t.id)>0)){n.next=12;break}return n.next=9,x({id:t.id,label:t.label});case 9:n.t0=n.sent,n.next=15;break;case 12:return n.next=14,_({label:t.label,parentId:t.copyId});case 14:n.t0=n.sent;case 15:"000000"!==(r=n.t0).resultCode&&(o()(i,e.getTargetData(e.$data.cacheData,t.id)),e.$message(r.resultMsg)),delete i.canEdit,e.$store.commit("UPDATE_SPACE_LIST",a),e.$store.dispatch("getSpaceTree",{});case 20:case"end":return n.stop()}},n,e)}))()},deleteData:function(t){var e=this;return l()(s.a.mark(function n(){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,I({id:t.id});case 2:"000000"===n.sent.resultCode&&e.$store.dispatch("getSpaceTree",{});case 4:case"end":return n.stop()}},n,e)}))()},add:function(t){console.log("++",t);try{var e=[].concat(p()(this.spaceList));this.$data.cacheData=JSON.parse(h()(e)),0===i()(this.getTargetData(e,"-1")).length?this.$store.commit("UPDATE_SPACE_LIST",this.setTargetData(e,t)):this.$message("请完成新增项")}catch(t){}},cancel:function(t){var e=[].concat(p()(this.spaceList)),n=this.getTargetData(e,t.id);if(n){o()(n,this.getTargetData(this.$data.cacheData,t.id)),delete n.canEdit;!function t(e){e.map(function(n,a){"-1"===n.id&&e.splice(a,1),n.children&&n.children.length>0&&t(n.children)})}(e),this.$store.commit("UPDATE_SPACE_LIST",e)}},getTargetData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={};return function t(a){a.map(function(a){a.id===e&&(n=a),a.children&&a.children.length>0&&t(a.children)})}(t),n},setTargetData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function t(n){n.map(function(n,a){n.id===e.id&&(n.children||(n.children=[]),n.children.push({id:"-1",label:"",canEdit:!0,copyId:e.id,variable:!0,parentId:n&&n.parentId&&n.parentId||"0"})),n.children&&n.children.length>0&&t(n.children)})}(t),0===parseInt(e.copyId)&&t.splice(0,0,{id:"-1",label:"",canEdit:!0,copyId:0,parentId:0,variable:!0}),this.$store.commit("UPDATE_SPACE_LIST",t),t},handleChange:function(t,e){var n=[].concat(p()(this.spaceList)),a=this.getTargetData(n,t.id);a&&(o()(a,this.getTargetData(this.$data.cacheData,t.id)),a.label=e,this.$store.commit("UPDATE_SPACE_LIST",n))}}},w=(n("Iztv"),n("KHd+")),$=Object(w.a)(k,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"space_edit"},[n("div",{staticClass:"custom-tree-container"},[n("el-button",{staticStyle:{margin:"10px"},attrs:{size:"mini",type:"primary"},on:{click:function(){return t.add({id:"-1",copyId:0,parentId:0,canEdit:!0,label:"",variable:!0})}}},[t._v("添加空间节点")]),t._v(" "),n("el-tree",{attrs:{data:t.spaceList,"expand-on-click-node":!1,props:t.defaultProps,"node-key":"id","default-expand-all":""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node,i=e.data;return n("span",{staticClass:"custom-tree-node"},[i.canEdit?n("a-input",{key:i.id,staticStyle:{padding:"0",margin:"0",height:"20px",width:"50%"},attrs:{value:i.label},on:{change:function(e){return t.handleChange(i,e.target.value)}}}):n("span",[t._v(t._s(a.label))]),t._v(" "),n("span",[i.canEdit||i.allowCreateInterface?t._e():n("el-button",{attrs:{slot:"reference",size:"mini",type:"text",icon:"el-icon-plus",circle:""},on:{click:function(){return t.add(i)}},slot:"reference"}),t._v(" "),i.canEdit?n("span",[n("a",{on:{click:function(){return t.save(i)}}},[t._v("保存")]),t._v(" "),n("a-popconfirm",{attrs:{title:"确认取消?","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(){return t.cancel(i)}}},[n("a",[t._v("取消")])])],1):n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit",circle:""},on:{click:function(){return t.edit(i)}}}),t._v(" "),i.canEdit?t._e():n("a-popconfirm",{attrs:{title:"确认删除?","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(){return t.deleteData(i)}}},[n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"}})],1)],1)],1)}}])})],1)])},[],!1,null,null,null);$.options.__file="edit.vue";e.default=$.exports},GQeE:function(t,e,n){t.exports={default:n("iq4v"),__esModule:!0}},Iztv:function(t,e,n){"use strict";var a=n("+JTq");n.n(a).a},Mqbl:function(t,e,n){var a=n("JB68"),i=n("w6GO");n("zn7N")("keys",function(){return function(t){return i(a(t))}})},"T/mn":function(t,e,n){"use strict";var a=n("h/pP");n.n(a).a},dhvm:function(t,e,n){"use strict";n.r(e);var a=n("QbLZ"),i=n.n(a),r=n("L2JU"),s={components:{spaceedit:n("Ebxm").default},data:function(){return{visible:!1,defaultProps:{children:"children",label:"label"}}},computed:i()({},Object(r.b)({spaceList:function(t){return t.business.spaceList}})),mounted:function(){this.$store.dispatch("getSpaceTree",{})},methods:{handleNodeClick:function(t){t.allowCreateInterface&&this.$store.dispatch("getInterfaceListWithId",{criteria:{spaceId:t.id},page:1,itemsPerPage:13})},goSpaceEdit:function(){this.$router.push({path:"/space/edit"})},showDrawer:function(){this.$data.visible=!0},onClose:function(){this.$data.visible=!1,this.$store.dispatch("getSpaceTree",{})}}},c=(n("uAlY"),n("KHd+")),o=Object(c.a)(s,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"space_list"},[n("el-button",{attrs:{type:"primary"},on:{click:t.showDrawer}},[t._v("\n    空间编辑\n  ")]),t._v(" "),n("div",[n("div",[n("a-drawer",{attrs:{width:720,visible:t.visible,"wrap-style":{height:"calc(100% - 108px)",overflow:"auto",paddingBottom:"108px"},placement:"left",title:"空间节点编辑"},on:{close:t.onClose}},[n("div",[n("spaceedit")],1)])],1),t._v(" "),n("el-tree",{attrs:{data:t.spaceList,props:t.defaultProps,"default-expand-all":!0},on:{"node-click":t.handleNodeClick}})],1)],1)},[],!1,null,"6e0a7868",null);o.options.__file="space_list.vue";var u=o.exports,l=n("14Xm"),d=n.n(l),p=n("D3Ub"),f=n.n(p),h=n("t3Un"),v=function(){var t=f()(d.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.a)({url:"/interface_http/delete",method:"post",param:n});case 2:return e=t.sent,t.abrupt("return",e||{});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),g={data:function(){return{defalutPagination:{},columns:[{title:"接口名称",dataIndex:"name",key:"name"},{title:"接口URL",dataIndex:"requestUri",key:"requestUri"},{title:"请求方式",width:100,dataIndex:"requestMethod",key:"requestMethod"},{title:"配置模式",width:110,dataIndex:"configModeText",key:"configModeText"},{title:"最近更新时间",dataIndex:"gmtModified",key:"gmtModified",width:"120px"},{title:"操作",key:"operation",scopedSlots:{customRender:"operation"},width:120}]}},computed:i()({},Object(r.b)({interfaceList:function(t){return t.business.interfaceList},spaceId:function(t){return t.business.spaceId},pagination:function(t){return t.business.pagination}})),watch:{"pagination.total":function(t){this.$data.defalutPagination.total=t}},mounted:function(){var t=this;return f()(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},!(parseInt(t.spaceId)>0)){e.next=7;break}return e.next=4,t.$store.dispatch("getInterfaceListWithId",{criteria:{spaceId:t.spaceId}});case 4:n=e.sent,e.next=10;break;case 7:return e.next=9,t.$store.dispatch("getInterfaceListAll",{});case 9:n=e.sent;case 10:n.data&&n.data.total&&n.data.total>0&&(t.$data.defalutPagination={pageSize:13,current:1,total:n.data.total,onChange:t.nextPage});case 11:case"end":return e.stop()}},e,t)}))()},methods:{headerRowClass:function(){return"background-color:rgb(246, 246, 246);"},Edit:function(t){t.id&&(this.$router.push({name:"interface_update",params:{id:t.id}}),this.$store.commit("UPDATE_NAR_BAR_ACTIVE",[]))},Delete:function(t){var e=this;return f()(d.a.mark(function n(){var a;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v({id:t.id});case 2:a=n.sent,e.$message(a.resultMsg),"000000"===a.resultCode&&e.$store.dispatch("getInterfaceListWithId",{criteria:{spaceId:t.spaceId}});case 5:case"end":return n.stop()}},n,e)}))()},nextPage:function(t){var e=this;return f()(d.a.mark(function n(){var a;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a={},!(parseInt(e.spaceId)>0)){n.next=7;break}return n.next=4,e.$store.dispatch("getInterfaceListWithId",{spaceId:e.spaceId,itemsPerPage:e.$data.defalutPagination.pageSize,page:t});case 4:a=n.sent,n.next=10;break;case 7:return n.next=9,e.$store.dispatch("getInterfaceListAll",{itemsPerPage:e.$data.defalutPagination.pageSize,page:t});case 9:a=n.sent;case 10:a.data&&a.data.total&&a.data.total>0&&(e.$data.defalutPagination={total:a.data.total});case 11:case"end":return n.stop()}},n,e)}))()},copyUrlSuc:function(t){this.$message({message:"复制成功",type:"success"})},copyUrlErr:function(){this.$message("复制失败")}}},m=(n("T/mn"),Object(c.a)(g,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"interface_list"},[n("a-table",{attrs:{columns:t.columns,"data-source":t.interfaceList,pagination:t.defalutPagination,bordered:""},scopedSlots:t._u([{key:"operation",fn:function(e,a,i){return[a.variable?n("div",{staticClass:"editable-row-operations"},[n("span",{staticStyle:{"margin-right":"15px"}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(){return t.Edit(a)}}})],1),t._v(" "),n("span",[n("a-popconfirm",{attrs:{title:"Sure to Delete?"},on:{confirm:function(){return t.Delete(a)}}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-minus",circle:""}})],1)],1)]):n("div",{staticClass:"editable-row-operations"},[n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return t.Edit(a)}}},[t._v("查看示例")])],1)]}}])})],1)},[],!1,null,null,null));m.options.__file="interface_list.vue";var b={name:"ListPage",components:{spacelist:u,interfacelist:m.exports},data:function(){return{}}},x=(n("4+qw"),Object(c.a)(b,function(){var t=this.$createElement,e=this._self._c||t;return e("el-container",[e("el-aside",{attrs:{width:"200px"}},[e("spacelist")],1),this._v(" "),e("el-main",[e("interfacelist")],1)],1)},[],!1,null,"165a81fa",null));x.options.__file="list.vue";e.default=x.exports},"gDS+":function(t,e,n){t.exports={default:n("oh+g"),__esModule:!0}},"h/pP":function(t,e,n){},iq4v:function(t,e,n){n("Mqbl"),t.exports=n("WEpk").Object.keys},"oh+g":function(t,e,n){var a=n("WEpk"),i=a.JSON||(a.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},t6V3:function(t,e,n){},uAlY:function(t,e,n){"use strict";var a=n("6V1f");n.n(a).a},zn7N:function(t,e,n){var a=n("Y7ZC"),i=n("WEpk"),r=n("KUxP");t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],s={};s[t]=e(n),a(a.S+a.F*r(function(){n(1)}),"Object",s)}}}]);